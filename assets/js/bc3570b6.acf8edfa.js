"use strict";(self.webpackChunkscaffold=self.webpackChunkscaffold||[]).push([[339],{9302:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>a});var t=o(4848),r=o(8453);const i={sidebar_label:"Rector"},s="Rector - Instant Upgrades and Automated Refactoring",l={id:"tools/rector",title:"Rector - Instant Upgrades and Automated Refactoring",description:"https://github.com/rectorphp/rector",source:"@site/content/tools/rector.mdx",sourceDirName:"tools",slug:"/tools/rector",permalink:"/tools/rector",draft:!1,unlisted:!1,editUrl:"https://github.com/drevops/scaffold/tree/develop/.scaffold/docs/content/tools/rector.mdx",tags:[],version:"current",frontMatter:{sidebar_label:"Rector"},sidebar:"docs",previous:{title:"Pygmy",permalink:"/tools/pygmy"},next:{title:"Renovate",permalink:"/tools/renovate"}},c={},a=[{value:"Usage",id:"usage",level:2},{value:"Check for violations",id:"check-for-violations",level:3},{value:"Fix violations",id:"fix-violations",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Config sets",id:"config-sets",level:3},{value:"Ignoring",id:"ignoring",level:2},{value:"Ignoring fail in CI",id:"ignoring-fail-in-ci",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"rector---instant-upgrades-and-automated-refactoring",children:"Rector - Instant Upgrades and Automated Refactoring"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://github.com/rectorphp/rector",children:"https://github.com/rectorphp/rector"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Rector instantly upgrades and refactors the PHP code of your application."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Scaffold comes with ",(0,t.jsx)(n.a,{href:"https://github.com/drevops/scaffold/blob/develop/rector.php",children:"pre-configured Rector configuration"}),"\nfor Drupal projects. The configuration is based on\nthe configuration provided\nby ",(0,t.jsx)(n.a,{href:"https://github.com/palantirnet/drupal-rector",children:"Drupal Rector"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(n.h3,{id:"check-for-violations",children:"Check for violations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"vendor/bin/rector --dry-run # Only see the diff of changes, do not save them to files.\n"})}),"\n",(0,t.jsx)(n.p,{children:"or"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"ahoy lint-be\n"})}),"\n",(0,t.jsx)(n.h3,{id:"fix-violations",children:"Fix violations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"vendor/bin/rector process\n"})}),"\n",(0,t.jsx)(n.p,{children:"or"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"ahoy lint-fix\n"})}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"https://getrector.com/documentation",children:"configuration reference"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["All global configuration takes place in\nthe ",(0,t.jsx)(n.a,{href:"https://github.com/drevops/scaffold/blob/develop/rector.php",children:(0,t.jsx)(n.code,{children:"rector.php"})}),"\nfile."]}),"\n",(0,t.jsx)(n.p,{children:"Targets include custom modules and themes, settings and tests."}),"\n",(0,t.jsx)(n.h3,{id:"config-sets",children:"Config sets"}),"\n",(0,t.jsxs)(n.p,{children:["Rector provides ",(0,t.jsx)(n.a,{href:"https://getrector.com/documentation/set-lists",children:"config sets"}),"\nfunctionality that allows to enable/disable rules in bulk."]}),"\n",(0,t.jsx)(n.p,{children:"Scaffold provides the config sets for Drupal 8 and Drupal 9 deprecated code and\ncode style fixes."}),"\n",(0,t.jsx)(n.p,{children:"The config sets are meant to be adjusted per-project as needed."}),"\n",(0,t.jsxs)(n.p,{children:["A full list of available config sets can be found in\nthe ",(0,t.jsx)(n.a,{href:"https://getrector.com/documentation/rules-overview",children:"Rules overview"})," page."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$rectorConfig->sets([\n    // Provided by Rector.\n    SetList::PHP_80,\n    SetList::PHP_81,\n    SetList::CODE_QUALITY,\n    SetList::CODING_STYLE,\n    SetList::DEAD_CODE,\n    SetList::INSTANCEOF,\n    SetList::TYPE_DECLARATION,\n    // Provided by Drupal Rector.\n    Drupal8SetList::DRUPAL_8,\n    Drupal9SetList::DRUPAL_9,\n    Drupal10SetList::DRUPAL_10,\n]);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"ignoring",children:"Ignoring"}),"\n",(0,t.jsxs)(n.p,{children:["See more\non ",(0,t.jsx)(n.a,{href:"https://getrector.com/documentation/ignoring-rules-or-paths",children:"Ignoring Rules Or Paths"}),"\npage."]}),"\n",(0,t.jsxs)(n.p,{children:["Ignoring rules ",(0,t.jsx)(n.strong,{children:"globally"})," takes place in\nthe ",(0,t.jsx)(n.a,{href:"https://github.com/drevops/scaffold/blob/develop/rector.php",children:(0,t.jsx)(n.code,{children:"rector.php"})})," file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$rectorConfig->skip([\n  SimplifyIfReturnBoolRector::class,\n]);\n"})}),"\n",(0,t.jsxs)(n.p,{children:["To ignore ",(0,t.jsx)(n.strong,{children:"all Rector rules"})," within a file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$rectorConfig->skip([\n  'file.php',\n  '*/other_file.php',\n]);\n"})}),"\n",(0,t.jsxs)(n.p,{children:["To ignore ",(0,t.jsx)(n.strong,{children:"a specific rule"})," within a file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"$rectorConfig->skip([\n  SimplifyIfReturnBoolRector::class => ['file.php'],\n]);\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Rector does not support ignoring of the ",(0,t.jsx)(n.strong,{children:"code blocks"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"ignoring-fail-in-ci",children:"Ignoring fail in CI"}),"\n",(0,t.jsx)(n.p,{children:"This tool runs in CI by default and fails the build if there are any violations."}),"\n",(0,t.jsxs)(n.p,{children:["Set ",(0,t.jsx)(n.code,{children:"DREVOPS_CI_RECTOR_IGNORE_FAILURE"})," environment variable to ",(0,t.jsx)(n.code,{children:"1"})," to ignore\nfailures. The tool will still run and report violations, if any."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>l});var t=o(6540);const r={},i=t.createContext(r);function s(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);